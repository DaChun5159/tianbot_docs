import { ssrRenderAttrs, ssrRenderStyle } from "vue/server-renderer";
import { useSSRContext } from "vue";
import { _ as _export_sfc } from "./plugin-vue_export-helper.cc2b3d55.js";
const __pageData = JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"use_guide/tianbot_mini/guide/slam/chapter3.md","filePath":"use_guide/tianbot_mini/guide/slam/chapter3.md"}');
const _sfc_main = { name: "use_guide/tianbot_mini/guide/slam/chapter3.md" };
function _sfc_ssrRender(_ctx, _push, _parent, _attrs, $props, $setup, $data, $options) {
  _push(`<div${ssrRenderAttrs(_attrs)}><p style="${ssrRenderStyle({ "font-size": "30px", "font-weight": "bolder", "text-align": "center" })}">Cartographer 建图</p><p><strong>视频地址</strong></p><div style="${ssrRenderStyle({ "position": "relative", "padding-bottom": "56.25%", "height": "0" })}"><iframe src="//player.bilibili.com/player.html?aid=807445441&amp;bvid=BV1834y167Gz&amp;cid=462755246&amp;p=1&amp;autoplay=0" frameborder="no" scrolling="no" style="${ssrRenderStyle({ "position": "absolute", "top": "0", "left": "0", "width": "100%", "height": "100%" })}"></iframe></div><h2 id="_1-功能包的下载" tabindex="-1">1.功能包的下载 <a class="header-anchor" href="#_1-功能包的下载" aria-label="Permalink to &quot;1.功能包的下载&quot;">​</a></h2><p>进入网址</p><ul><li><a href="https://github.com/JackyMao1999/tbm_slam_cartographer" target="_blank" rel="noreferrer">https://github.com/JackyMao1999/tbm_slam_cartographer</a></li></ul><p>按照使用方法安装</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#82AAFF" })}">cd</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">~/tianbot_mini_ws/src</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">git</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">clone</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">https://github.com/tianbot/tianbot_mini.git</span></span>
<span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">git</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">clone</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">https://github.com/JackyMao1999/tbm_slam_cartographer.git</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#82AAFF" })}">source</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">/opt/ros/melodic/setup.bash</span></span>
<span class="line"><span style="${ssrRenderStyle({ "color": "#82AAFF" })}">cd</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">~/tianbot_mini_ws/</span></span>
<span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">catkin_make</span></span>
<span class="line"><span style="${ssrRenderStyle({ "color": "#82AAFF" })}">echo</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#89DDFF" })}">&quot;</span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">source ~/tianbot_mini_ws/devel/setup.bash --extend</span><span style="${ssrRenderStyle({ "color": "#89DDFF" })}">&quot;</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#89DDFF" })}">&gt;&gt;</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">~/.bashrc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-X4Owg" id="tab-N6sPYyP" checked="checked"><label for="tab-N6sPYyP">melodic</label><input type="radio" name="group-X4Owg" id="tab-M_DSqlb"><label for="tab-M_DSqlb">noetic</label><input type="radio" name="group-X4Owg" id="tab-8drF1C6"><label for="tab-8drF1C6">通用</label></div><div class="blocks"><div class="language-sh active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#82AAFF" })}">source</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">/opt/ros/melodic/setup.bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#82AAFF" })}">source</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">/opt/ros/melodic/setup.bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#82AAFF" })}">source</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">/opt/ros/</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}">$ROS_DISTRO</span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">/setup.bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></div></div><p>安装包的位置，安装cartographer在src下</p><p>补充工作空间和安装包：</p><p><img src="https://img.kancloud.cn/8e/02/8e023452491101d38070271de740ace8_956x302.png" alt=""></p><p>在主文件夹下tianbot_mini_ws是工作空间，工作空间下src目录下的是安装包。 工作空间（workspace）是一个存放工程开发相关文件的文件夹，里面包括有：</p><ul><li>src：代码空间（Source Space）</li><li>build： 编译空间（Build Space）</li><li>devel：开发空间（Development Space）</li><li>install：安装空间（Install Space）</li></ul><p>这篇文章详细的介绍了工作空间与安装包： <a href="https://www.guyuehome.com/35887" target="_blank" rel="noreferrer">https://www.guyuehome.com/35887</a></p><p>我们继续讲解Cartographer，为验证是否安装成功，打开终端</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">rospack</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">profile</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>再新打开一个终端</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">rospack</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">list</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#89DDFF" })}">|</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">grep</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">tbm_slam</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.kancloud.cn/c7/09/c709908119671e6b60038cd1e634ba74_727x57.png" alt=""></p><p>这样就安装成功。</p><h2 id="_2-无imu下的cartographer" tabindex="-1">2.无IMU下的Cartographer <a class="header-anchor" href="#_2-无imu下的cartographer" aria-label="Permalink to &quot;2.无IMU下的Cartographer&quot;">​</a></h2><div style="${ssrRenderStyle({ "position": "relative", "padding-bottom": "56.25%", "height": "0" })}"><iframe src="//player.bilibili.com/player.html?aid=507461315&amp;bvid=BV1Gg411A72h&amp;cid=462762630&amp;p=1&amp;autoplay=0" frameborder="no" scrolling="no" style="${ssrRenderStyle({ "position": "absolute", "top": "0", "left": "0", "width": "100%", "height": "100%" })}"></iframe></div><p>启动小车，启动雷达：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">tianbot_mini</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">bringup,launch</span></span>
<span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">tianbot_mini</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">lidar.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">tbm_slam_cartographer</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">slam_laser.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>此处可能会报错 ,原因是版本更替是因为雷达的话题名字错误</p><p><img src="https://img.kancloud.cn/4b/4e/4b4eb15b519d55f4592e250dd2f613ac_893x405.png" alt=""></p><p>改过来后，可以手拿对周围的环境建图，速度要慢，走太快的话建图效果不好，纯激光。</p><p>添加MarkerArray就可以看到轨迹：</p><p><img src="https://img.kancloud.cn/f7/10/f7106e74a311971b86fda6dc6edf7f58_1920x1080.png" alt=""></p><p>轨迹是根据激光来算出来的，并没有融合IMU。</p><p>复制slam_laser.launch并重命名lds_slam_laser.launch删掉cmd_vel和Move_base后同样可以移动，但删去TF变换就不行了，说明TF变换和话题一样很重要。</p><p><img src="https://img.kancloud.cn/a1/18/a1182f0dc76fe9bb891dac687c3c2b32_1920x1080.png" alt=""></p><p>此时再启动打开RViz构建地图与之前slam_laser.launch效果相同。</p><div class="tip custom-block"><p class="custom-block-title">注意</p><p>可能会遇到不出轨迹等问题，要注意RViz的topic选项LaserScan,MarkerArray等选项的topic因为版本更替问题会有错误，点开这些topic重新选择一下即可。</p></div><h2 id="_3-基于手机端imu下的cartographer" tabindex="-1">3.基于手机端IMU下的Cartographer <a class="header-anchor" href="#_3-基于手机端imu下的cartographer" aria-label="Permalink to &quot;3.基于手机端IMU下的Cartographer&quot;">​</a></h2><div style="${ssrRenderStyle({ "position": "relative", "padding-bottom": "56.25%", "height": "0" })}"><iframe src="//player.bilibili.com/player.html?aid=252471784&amp;bvid=BV17Y411H7sW&amp;cid=462767558&amp;p=1&amp;autoplay=0" frameborder="no" scrolling="no" style="${ssrRenderStyle({ "position": "absolute", "top": "0", "left": "0", "width": "100%", "height": "100%" })}"></iframe></div><p>手机端的IMU传感器,关注tianbot微信公众号后台回复：迷你机器人 打开终端：Ubuntu20.04的版本为</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">sudo</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">apt-get</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">install</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">ros-noetic-rosbridge-server</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">rosbridge_server</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">rosbridge_websocket.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Ifconfig找到IP地址，输入到APP中，点击Connnct</p><p>手机和电脑连接同一个wifi，但不要连接MINI自己发出来的WIFI信号</p><p>打开新的终端 rostopic list</p><p>有一个/imu的话题</p><p><img src="https://img.kancloud.cn/4a/41/4a41943f7e8f30a1e876eff1db34ca9d_671x114.png" alt=""></p><p>成功连接之后 rostopic echo /imu 就可以看到数据 只看一次的话 rostopic echo.imu -n1</p><p><img src="https://img.kancloud.cn/a4/e6/a4e6f01e8bff87fb803358a8fe55998f_737x480.png" alt=""></p><p>直接打开rviz,增加imu，选择imu，就可以看到坐标系的变化</p><p><img src="https://img.kancloud.cn/c0/ea/c0ea429e18e2600bca307bb1d6870270_1920x1080.png" alt=""></p><p>此时沿Z轴方向也就是上下移动小车，可观察到明显的大小变化。</p><p>改lds_laser_imu.lua文件 Tracking_frame=’imu’</p><p>Use_imu_date=true</p><p><img src="https://img.kancloud.cn/5e/2c/5e2c808c969662bf02c201650a65b3eb_1112x263.png" alt=""></p><p><img src="https://img.kancloud.cn/01/35/0135f6f46d69bf41e5a302994f19d4e7_748x172.png" alt=""></p><p>复制lds_cartographer.launch为lds_cartographer_imu.launch</p><p>配置文件lds_laser_imu.lua，话题对，TF要对，TF复制，laser改为imu，上边的arg name 也对应的复制粘贴</p><p><img src="https://img.kancloud.cn/6a/39/6a39310323c8e41d7aae372f9029d3ea_1920x1080.png" alt=""></p><p>有IMU的存在效果会好一些</p><p>在关闭所有终端，打开有IMU的Cartographer如下：</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p>此时电脑连接的是路由器的WIFI</p></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">tianbot_mini</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">bringup.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">tianbot_mini</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">lidar.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">rosbridge_server</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">rosbridge_websocket.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="${ssrRenderStyle({ "color": "#FFCB6B" })}">roslaunch</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">tbm_slam_cartographer</span><span style="${ssrRenderStyle({ "color": "#A6ACCD" })}"> </span><span style="${ssrRenderStyle({ "color": "#C3E88D" })}">lds_cartographer_imu.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>连接手机，ifconfig查找IP地址，手机端Connect,检验是否连接上rostopic list，若有话题/imu，则成功连接。</p><p>注意： 如果手机IMU未成功连接，会出现下图警告：</p><p><img src="https://img.kancloud.cn/c8/4e/c84e0e975d152e175b75142414b234ed_1920x1080.png" alt=""></p><p>在确定手机端IMU已连接的情况下，可重启手机端IMU的APP 此时先不固定手机，小车放置不动，仅移动手机就可看到地图的变化，说明IMU确实在工作。</p><p><img src="https://img.kancloud.cn/fc/3b/fc3bb33f06fc1b68f9abaa6f2e9485ed_1920x1080.png" alt=""></p><p>此时将手机固定到MIMI的支架上，就可以移动建图。</p></div>`);
}
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("use_guide/tianbot_mini/guide/slam/chapter3.md");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};
const chapter3 = /* @__PURE__ */ _export_sfc(_sfc_main, [["ssrRender", _sfc_ssrRender]]);
export {
  __pageData,
  chapter3 as default
};
